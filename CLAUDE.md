# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Development Commands

**Start the React application:**
```bash
npm install
npm start
```
- Runs on localhost:3000
- React development server with hot reloading

**Build for production:**
```bash
npm run build
```

**Data Processing Pipeline:**
```bash
# 1. Generate schedule data (run first)
node src/services/scheduleGenerator.js

# 2. Process all CSV stats files from BaseballScraper
./process_all_stats.sh

# 3. Generate additional analysis files
node src/services/generateAdditionalStats.js
node src/services/generatePitcherMatchups.js

# 4. Run daily update (generates predictions)
./daily_update.sh [YYYY-MM-DD]
```

**Rolling stats generation:**
```bash
./generate_rolling_stats.sh
```

## Architecture Overview

### Core Application Structure
- **React Router SPA** with main routes: `/` (Dashboard), `/players`, `/teams`, `/games`, `/capsheet`, `/matchup-analyzer`, `/pinheads-playhouse`
- **Data Service Layer** (`src/services/dataService.js`) - Centralized data loading with caching for JSON files
- **Team Filter Context** - Global state for filtering players/games by team with matchup analysis

### Data Flow Architecture
1. **Raw Data Sources**: 
   - Daily JSON files: `public/data/YYYY/month/month_DD_YYYY.json`
   - Static data: `teams.json`, `rosters.json`, `handicappers.json`
   - Generated predictions: `public/data/predictions/`

2. **Processing Pipeline**:
   - CSV files (from external BaseballScraper) → `statLoader.js` → Daily JSON
   - Daily JSON → Prediction services → Analysis JSON files
   - Historical data aggregation via `fetchPlayerDataForDateRange()`

3. **Frontend Data Loading**:
   - Lazy loading with fallback to closest available date
   - Multi-level caching (dataCache object)
   - Date-based file resolution with month name conversion

### Component Architecture

**Dashboard System:**
- **Modular Card System**: Individual card components in `src/components/cards/`
- **Card Registry**: `cardRegistry.js` contains configuration-driven card definitions
- **Dynamic Loading**: Cards fetch their own data sources with fallback mechanisms
- **Team Filtering**: Context-based filtering applied across all dashboard cards

**CapSheet System:**
- **Handicapping Tools**: Bet slip management, player analysis, performance tracking
- **Multi-game History**: `findMultiGamePlayerStats()` for detailed player analysis
- **Export/Import**: Handicapper data persistence and sharing

**Component Patterns:**
- **Hook-based State**: Custom hooks in `hooks/` for reusable logic
- **CSS Modules**: Component-specific styling with `.css` files
- **Context Providers**: TeamFilterContext wraps main application routes

### Data Processing Services

**Key Services:**
- `generateHRPredictions3.js` - Home run prediction algorithm
- `generateAdditionalStats.js` - Player performance metrics
- `generatePitcherMatchups.js` - Pitcher vs batter analysis
- `generateRollingStats.js` - Rolling statistical windows (7/30/season)

**Analysis Features:**
- **Opponent Matchup Analysis**: Historical player vs team performance with game verification
- **Time Slot Performance**: Day-of-week and time-based performance patterns  
- **Streak Analysis**: Hit streaks, drought predictions, continuation probabilities
- **Multi-Hit Analysis**: Players likely to record multiple hits

### File Organization
- `src/components/cards/` - Dashboard card components
- `src/services/` - Data processing and analysis services
- `public/data/` - JSON data files organized by year/month
- `public/data/predictions/` - Generated analysis files
- `public/data/logos/` - Team and application logos

### Development Notes
- **Date Format**: All dates use YYYY-MM-DD format internally
- **Player Identification**: Combination of name + team for uniqueness
- **Performance Caching**: Extensive caching to minimize file reads
- **Error Handling**: Graceful fallbacks for missing data files
- **Team Abbreviations**: Consistent 3-letter abbreviations throughout

### Data Dependencies
This application requires:
1. BaseballScraper CSV files in `../BaseballScraper/` directory
2. MLB schedule data (generated by scheduleGenerator.js)
3. Daily statistics JSON files in the date-based directory structure
4. Prediction files must be generated before dashboard displays complete data

The application handles missing data gracefully and will find the closest available date when specific date data is not available.